/*
 * Image/J Plugins
 * Copyright (C) 2002-2018 Jarek Sacha
 * Author's email: jpsacha at gmail [dot] com
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 *
 * Latest release available at http://sourceforge.net/projects/ij-plugins/
 */

package net.sf.ijplugins.debayer2sx

import ij.IJ
import ij.process.{ByteProcessor, ColorProcessor, FloatProcessor, ShortProcessor}
import net.sf.ijplugins.debayer2sx.DDFAPD._
import net.sf.ijplugins.debayer2sx.process.add
import org.scalatest.{BeforeAndAfter, FlatSpec, Matchers}


class DDFAPDTest extends FlatSpec with BeforeAndAfter with Matchers {

  behavior of "DDFAPDTest"

  private var bay32x32: ShortProcessor = _
  private var g0Expected: Array[Short] = _
  private var f1Expected: Array[Float] = _
  private var ghExpected: Array[Float] = _
  private var gvExpected: Array[Float] = _
  //  private var dstGExpected: Array[Float] = _
  //  private var interpDirExpected: Array[Byte] = _


  it should "compute `filtImg` 32x32" in {
    val G0 = new ShortProcessor(32, 16, g0Expected, null)
    val h1 = Array[Float](0f, 0.5f, 0f, 0.5f, 0f)
    val hh1 = add(h1, Array[Float](0f, 0f, 1f, 0f, 0f))
    val f1 = filtImg(hh1, G0.convertToFloatProcessor(), 1)

    f1.getWidth should be(32)
    f1.getHeight should be(16)

    val f1Array = f1.getPixels.asInstanceOf[Array[Float]]

    f1Array should equal(f1Expected)
  }

  it should "compute `intDirezG` 32x32" in {
    val r: (FloatProcessor, FloatProcessor) = intDirezG(bay32x32.convertToFloatProcessor())
    val Gh = r._1
    val Gv = r._2

    Gh.getWidth should be(32)
    Gh.getHeight should be(32)
    val ghArray = Gh.getPixels.asInstanceOf[Array[Float]]
    ghArray should equal(ghExpected)

    Gv.getWidth should be(32)
    Gv.getHeight should be(32)
    val gvArray = Gv.getPixels.asInstanceOf[Array[Float]]
    gvArray should equal(gvExpected)
  }

  it should "compute `decision` 32x32" in {
    val gh = new FloatProcessor(32, 32, ghExpected)
    val gv = new FloatProcessor(32, 32, gvExpected)
    val (dstG, interpDir) = decision(gh, gv, bay32x32.convertToFloatProcessor())

    // Reference was computed with int round up, we compute at float precision, no point comparing details here.
    //    compare(dstGExpected, dstG, 32, 32, 1)
    //    compare(interpDirExpected, interpDir, 32, 32)
  }

  it should "compute `debayerGR` 32x32" in {
    val x = debayerGR(bay32x32.convertToFloatProcessor(), 16, doRefine = true)
    assert(x != null)
  }

  it should "debayer Lighthouse_bayerGR8.png" in {
    val imp = IJ.openImage("../data/Lighthouse_bayerGR8.png")
    assert(imp != null)
    val bay = imp.getProcessor.asInstanceOf[ByteProcessor]
    assert(bay != null)

    val cp = debayerGR(bay, doRefine = true)

    // Read expected result
    val impRef = IJ.openImage("../data/Lighthouse_bayerGR8_DDFAPD_refined.png")
    assert(impRef != null)
    val cpRef = impRef.getProcessor.asInstanceOf[ColorProcessor]
    assert(cpRef != null)

    Utils.compare(cp, cpRef)
  }

  before {

    val pixels = Array[Short](
      103, 234, 132, 128, 63, 88, 84, 221, 19, 196, 140, 39, 240, 133, 50, 98, 73, 53, 96, 139, 146, 163, 135, 112, 5, 160, 240, 44, 197, 109, 145, 121,
      226, 229, 1, 84, 98, 85, 52, 17, 181, 59, 191, 22, 123, 105, 155, 186, 21, 102, 129, 80, 237, 168, 234, 153, 206, 46, 249, 62, 190, 244, 96, 91,
      179, 123, 176, 44, 110, 147, 196, 247, 60, 150, 215, 116, 138, 55, 210, 227, 149, 227, 195, 97, 221, 172, 249, 184, 45, 146, 27, 164, 113, 185, 54, 121,
      61, 113, 242, 160, 212, 221, 17, 25, 102, 117, 42, 171, 56, 219, 207, 14, 39, 65, 12, 202, 43, 190, 149, 173, 42, 41, 45, 207, 13, 148, 202, 171,
      194, 79, 223, 147, 211, 50, 243, 140, 68, 220, 231, 212, 24, 220, 205, 35, 18, 247, 185, 214, 45, 215, 30, 54, 46, 231, 191, 218, 22, 138, 37, 245,
      74, 14, 28, 192, 115, 172, 40, 103, 213, 169, 26, 202, 15, 72, 181, 220, 148, 158, 179, 174, 62, 132, 237, 20, 177, 19, 12, 101, 204, 180, 125, 22,
      71, 192, 90, 39, 97, 230, 73, 27, 254, 90, 190, 182, 209, 157, 220, 107, 73, 42, 117, 106, 192, 38, 151, 70, 54, 86, 18, 29, 167, 1, 3, 204,
      1, 33, 61, 91, 237, 50, 175, 185, 166, 88, 186, 120, 197, 199, 199, 105, 92, 211, 149, 164, 50, 97, 226, 222, 76, 148, 125, 20, 8, 200, 47, 151,
      95, 91, 143, 36, 189, 76, 36, 157, 180, 64, 183, 181, 50, 244, 52, 245, 185, 167, 86, 54, 251, 210, 108, 143, 196, 121, 217, 92, 142, 237, 124, 233,
      111, 101, 156, 217, 188, 127, 131, 200, 238, 243, 34, 245, 229, 235, 254, 192, 219, 139, 43, 158, 181, 43, 155, 118, 128, 206, 255, 212, 184, 2, 214, 25,
      77, 226, 77, 86, 242, 227, 184, 145, 176, 76, 114, 129, 175, 98, 23, 251, 89, 64, 102, 172, 44, 84, 18, 110, 232, 135, 1, 54, 28, 211, 36, 75,
      74, 5, 204, 70, 130, 128, 237, 207, 145, 40, 130, 78, 168, 41, 166, 59, 246, 10, 235, 153, 219, 247, 236, 198, 14, 58, 138, 202, 55, 196, 187, 13,
      62, 216, 203, 1, 202, 70, 187, 147, 97, 92, 135, 202, 253, 203, 55, 24, 244, 59, 57, 88, 232, 206, 164, 167, 111, 181, 220, 167, 207, 255, 176, 129,
      239, 73, 199, 205, 115, 136, 191, 241, 162, 189, 220, 60, 8, 29, 62, 98, 52, 92, 92, 93, 246, 56, 26, 168, 146, 38, 232, 6, 35, 58, 8, 196,
      220, 64, 89, 127, 217, 147, 104, 223, 92, 180, 173, 59, 108, 40, 86, 128, 196, 162, 83, 43, 146, 255, 179, 41, 144, 168, 216, 201, 225, 235, 125, 72,
      101, 125, 13, 137, 99, 105, 61, 129, 104, 179, 206, 118, 125, 91, 50, 145, 157, 252, 21, 203, 144, 16, 101, 110, 210, 162, 224, 236, 236, 164, 248, 57,
      122, 186, 181, 222, 189, 3, 133, 201, 94, 1, 135, 158, 149, 217, 129, 250, 235, 53, 131, 126, 45, 108, 21, 129, 32, 58, 191, 126, 3, 26, 28, 84,
      144, 51, 254, 185, 249, 179, 56, 121, 119, 95, 244, 157, 21, 149, 243, 126, 154, 193, 213, 90, 131, 103, 54, 96, 76, 46, 30, 213, 96, 68, 190, 116,
      125, 55, 41, 171, 133, 129, 215, 212, 128, 230, 17, 31, 168, 150, 101, 102, 179, 226, 231, 198, 140, 102, 63, 122, 0, 42, 130, 33, 42, 195, 163, 188,
      69, 249, 29, 45, 110, 97, 169, 82, 233, 81, 138, 31, 13, 237, 149, 254, 190, 120, 185, 60, 42, 28, 58, 87, 243, 38, 43, 194, 138, 206, 152, 130,
      253, 151, 233, 140, 53, 16, 208, 249, 52, 152, 72, 72, 142, 147, 155, 66, 98, 40, 98, 216, 126, 108, 179, 198, 196, 51, 212, 236, 26, 26, 127, 97,
      47, 77, 123, 245, 82, 91, 203, 71, 86, 76, 123, 188, 182, 2, 182, 170, 64, 207, 76, 209, 136, 157, 193, 98, 192, 244, 237, 213, 10, 120, 145, 231,
      220, 247, 218, 152, 28, 59, 120, 18, 146, 32, 175, 105, 124, 207, 102, 246, 9, 121, 177, 216, 50, 252, 140, 182, 35, 4, 43, 66, 238, 56, 109, 247,
      8, 229, 207, 206, 96, 52, 79, 192, 124, 99, 53, 212, 158, 155, 219, 171, 120, 29, 225, 94, 159, 56, 141, 123, 89, 245, 226, 54, 248, 236, 19, 160,
      84, 48, 47, 252, 84, 208, 176, 212, 67, 209, 155, 239, 54, 122, 235, 76, 165, 224, 236, 98, 6, 90, 161, 186, 38, 6, 99, 133, 92, 82, 74, 33,
      191, 0, 63, 226, 87, 100, 252, 236, 148, 251, 83, 102, 165, 68, 192, 135, 71, 162, 20, 220, 81, 68, 252, 240, 127, 248, 97, 101, 164, 219, 143, 158,
      164, 182, 13, 54, 209, 13, 197, 83, 224, 220, 225, 13, 97, 66, 73, 0, 132, 24, 123, 118, 136, 74, 162, 132, 207, 76, 69, 122, 17, 66, 162, 98,
      43, 222, 155, 8, 136, 96, 212, 205, 15, 21, 34, 146, 26, 123, 203, 226, 62, 232, 32, 146, 83, 48, 153, 231, 162, 134, 222, 254, 53, 224, 238, 253,
      243, 30, 198, 115, 133, 198, 180, 137, 112, 86, 26, 191, 96, 58, 36, 103, 76, 8, 64, 177, 154, 5, 232, 55, 176, 220, 189, 154, 10, 48, 250, 73,
      139, 9, 130, 3, 198, 42, 152, 118, 21, 60, 245, 81, 67, 12, 129, 77, 166, 10, 226, 245, 92, 115, 146, 223, 163, 229, 114, 241, 120, 194, 23, 180,
      64, 153, 7, 121, 30, 233, 192, 210, 144, 81, 39, 126, 61, 43, 156, 243, 228, 253, 50, 139, 34, 62, 85, 21, 186, 48, 181, 125, 38, 8, 169, 137,
      148, 154, 253, 243, 160, 81, 127, 243, 138, 252, 39, 56, 159, 66, 180, 117, 220, 175, 31, 162, 233, 222, 245, 119, 220, 169, 241, 112, 253, 164, 154, 49,
    )
    bay32x32 = new ShortProcessor(32, 32, pixels, null)

    g0Expected = Array[Short](
      103, 0, 132, 0, 63, 0, 84, 0, 19, 0, 140, 0, 240, 0, 50, 0, 73, 0, 96, 0, 146, 0, 135, 0, 5, 0, 240, 0, 197, 0, 145, 0,
      179, 0, 176, 0, 110, 0, 196, 0, 60, 0, 215, 0, 138, 0, 210, 0, 149, 0, 195, 0, 221, 0, 249, 0, 45, 0, 27, 0, 113, 0, 54, 0,
      194, 0, 223, 0, 211, 0, 243, 0, 68, 0, 231, 0, 24, 0, 205, 0, 18, 0, 185, 0, 45, 0, 30, 0, 46, 0, 191, 0, 22, 0, 37, 0,
      71, 0, 90, 0, 97, 0, 73, 0, 254, 0, 190, 0, 209, 0, 220, 0, 73, 0, 117, 0, 192, 0, 151, 0, 54, 0, 18, 0, 167, 0, 3, 0,
      95, 0, 143, 0, 189, 0, 36, 0, 180, 0, 183, 0, 50, 0, 52, 0, 185, 0, 86, 0, 251, 0, 108, 0, 196, 0, 217, 0, 142, 0, 124, 0,
      77, 0, 77, 0, 242, 0, 184, 0, 176, 0, 114, 0, 175, 0, 23, 0, 89, 0, 102, 0, 44, 0, 18, 0, 232, 0, 1, 0, 28, 0, 36, 0,
      62, 0, 203, 0, 202, 0, 187, 0, 97, 0, 135, 0, 253, 0, 55, 0, 244, 0, 57, 0, 232, 0, 164, 0, 111, 0, 220, 0, 207, 0, 176, 0,
      220, 0, 89, 0, 217, 0, 104, 0, 92, 0, 173, 0, 108, 0, 86, 0, 196, 0, 83, 0, 146, 0, 179, 0, 144, 0, 216, 0, 225, 0, 125, 0,
      122, 0, 181, 0, 189, 0, 133, 0, 94, 0, 135, 0, 149, 0, 129, 0, 235, 0, 131, 0, 45, 0, 21, 0, 32, 0, 191, 0, 3, 0, 28, 0,
      125, 0, 41, 0, 133, 0, 215, 0, 128, 0, 17, 0, 168, 0, 101, 0, 179, 0, 231, 0, 140, 0, 63, 0, 0, 0, 130, 0, 42, 0, 163, 0,
      253, 0, 233, 0, 53, 0, 208, 0, 52, 0, 72, 0, 142, 0, 155, 0, 98, 0, 98, 0, 126, 0, 179, 0, 196, 0, 212, 0, 26, 0, 127, 0,
      220, 0, 218, 0, 28, 0, 120, 0, 146, 0, 175, 0, 124, 0, 102, 0, 9, 0, 177, 0, 50, 0, 140, 0, 35, 0, 43, 0, 238, 0, 109, 0,
      84, 0, 47, 0, 84, 0, 176, 0, 67, 0, 155, 0, 54, 0, 235, 0, 165, 0, 236, 0, 6, 0, 161, 0, 38, 0, 99, 0, 92, 0, 74, 0,
      164, 0, 13, 0, 209, 0, 197, 0, 224, 0, 225, 0, 97, 0, 73, 0, 132, 0, 123, 0, 136, 0, 162, 0, 207, 0, 69, 0, 17, 0, 162, 0,
      243, 0, 198, 0, 133, 0, 180, 0, 112, 0, 26, 0, 96, 0, 36, 0, 76, 0, 64, 0, 154, 0, 232, 0, 176, 0, 189, 0, 10, 0, 250, 0,
      64, 0, 7, 0, 30, 0, 192, 0, 144, 0, 39, 0, 61, 0, 156, 0, 228, 0, 50, 0, 34, 0, 85, 0, 186, 0, 181, 0, 38, 0, 169, 0,

    )

    f1Expected = Array[Float](
      103.0f, 117.5f, 132.0f, 97.5f, 63.0f, 73.5f, 84.0f, 51.5f, 19.0f, 79.5f, 140.0f, 190.0f, 240.0f, 145.0f, 50.0f, 61.5f, 73.0f, 84.5f, 96.0f, 121.0f, 146.0f, 140.5f, 135.0f, 70.0f, 5.0f, 122.5f, 240.0f, 218.5f, 197.0f, 171.0f, 145.0f, 145.0f,
      179.0f, 177.5f, 176.0f, 143.0f, 110.0f, 153.0f, 196.0f, 128.0f, 60.0f, 137.5f, 215.0f, 176.5f, 138.0f, 174.0f, 210.0f, 179.5f, 149.0f, 172.0f, 195.0f, 208.0f, 221.0f, 235.0f, 249.0f, 147.0f, 45.0f, 36.0f, 27.0f, 70.0f, 113.0f, 83.5f, 54.0f, 54.0f,
      194.0f, 208.5f, 223.0f, 217.0f, 211.0f, 227.0f, 243.0f, 155.5f, 68.0f, 149.5f, 231.0f, 127.5f, 24.0f, 114.5f, 205.0f, 111.5f, 18.0f, 101.5f, 185.0f, 115.0f, 45.0f, 37.5f, 30.0f, 38.0f, 46.0f, 118.5f, 191.0f, 106.5f, 22.0f, 29.5f, 37.0f, 37.0f,
      71.0f, 80.5f, 90.0f, 93.5f, 97.0f, 85.0f, 73.0f, 163.5f, 254.0f, 222.0f, 190.0f, 199.5f, 209.0f, 214.5f, 220.0f, 146.5f, 73.0f, 95.0f, 117.0f, 154.5f, 192.0f, 171.5f, 151.0f, 102.5f, 54.0f, 36.0f, 18.0f, 92.5f, 167.0f, 85.0f, 3.0f, 3.0f,
      95.0f, 119.0f, 143.0f, 166.0f, 189.0f, 112.5f, 36.0f, 108.0f, 180.0f, 181.5f, 183.0f, 116.5f, 50.0f, 51.0f, 52.0f, 118.5f, 185.0f, 135.5f, 86.0f, 168.5f, 251.0f, 179.5f, 108.0f, 152.0f, 196.0f, 206.5f, 217.0f, 179.5f, 142.0f, 133.0f, 124.0f, 124.0f,
      77.0f, 77.0f, 77.0f, 159.5f, 242.0f, 213.0f, 184.0f, 180.0f, 176.0f, 145.0f, 114.0f, 144.5f, 175.0f, 99.0f, 23.0f, 56.0f, 89.0f, 95.5f, 102.0f, 73.0f, 44.0f, 31.0f, 18.0f, 125.0f, 232.0f, 116.5f, 1.0f, 14.5f, 28.0f, 32.0f, 36.0f, 36.0f,
      62.0f, 132.5f, 203.0f, 202.5f, 202.0f, 194.5f, 187.0f, 142.0f, 97.0f, 116.0f, 135.0f, 194.0f, 253.0f, 154.0f, 55.0f, 149.5f, 244.0f, 150.5f, 57.0f, 144.5f, 232.0f, 198.0f, 164.0f, 137.5f, 111.0f, 165.5f, 220.0f, 213.5f, 207.0f, 191.5f, 176.0f, 176.0f,
      220.0f, 154.5f, 89.0f, 153.0f, 217.0f, 160.5f, 104.0f, 98.0f, 92.0f, 132.5f, 173.0f, 140.5f, 108.0f, 97.0f, 86.0f, 141.0f, 196.0f, 139.5f, 83.0f, 114.5f, 146.0f, 162.5f, 179.0f, 161.5f, 144.0f, 180.0f, 216.0f, 220.5f, 225.0f, 175.0f, 125.0f, 125.0f,
      122.0f, 151.5f, 181.0f, 185.0f, 189.0f, 161.0f, 133.0f, 113.5f, 94.0f, 114.5f, 135.0f, 142.0f, 149.0f, 139.0f, 129.0f, 182.0f, 235.0f, 183.0f, 131.0f, 88.0f, 45.0f, 33.0f, 21.0f, 26.5f, 32.0f, 111.5f, 191.0f, 97.0f, 3.0f, 15.5f, 28.0f, 28.0f,
      125.0f, 83.0f, 41.0f, 87.0f, 133.0f, 174.0f, 215.0f, 171.5f, 128.0f, 72.5f, 17.0f, 92.5f, 168.0f, 134.5f, 101.0f, 140.0f, 179.0f, 205.0f, 231.0f, 185.5f, 140.0f, 101.5f, 63.0f, 31.5f, 0, 65.0f, 130.0f, 86.0f, 42.0f, 102.5f, 163.0f, 163.0f,
      253.0f, 243.0f, 233.0f, 143.0f, 53.0f, 130.5f, 208.0f, 130.0f, 52.0f, 62.0f, 72.0f, 107.0f, 142.0f, 148.5f, 155.0f, 126.5f, 98.0f, 98.0f, 98.0f, 112.0f, 126.0f, 152.5f, 179.0f, 187.5f, 196.0f, 204.0f, 212.0f, 119.0f, 26.0f, 76.5f, 127.0f, 127.0f,
      220.0f, 219.0f, 218.0f, 123.0f, 28.0f, 74.0f, 120.0f, 133.0f, 146.0f, 160.5f, 175.0f, 149.5f, 124.0f, 113.0f, 102.0f, 55.5f, 9.0f, 93.0f, 177.0f, 113.5f, 50.0f, 95.0f, 140.0f, 87.5f, 35.0f, 39.0f, 43.0f, 140.5f, 238.0f, 173.5f, 109.0f, 109.0f,
      84.0f, 65.5f, 47.0f, 65.5f, 84.0f, 130.0f, 176.0f, 121.5f, 67.0f, 111.0f, 155.0f, 104.5f, 54.0f, 144.5f, 235.0f, 200.0f, 165.0f, 200.5f, 236.0f, 121.0f, 6.0f, 83.5f, 161.0f, 99.5f, 38.0f, 68.5f, 99.0f, 95.5f, 92.0f, 83.0f, 74.0f, 74.0f,
      164.0f, 88.5f, 13.0f, 111.0f, 209.0f, 203.0f, 197.0f, 210.5f, 224.0f, 224.5f, 225.0f, 161.0f, 97.0f, 85.0f, 73.0f, 102.5f, 132.0f, 127.5f, 123.0f, 129.5f, 136.0f, 149.0f, 162.0f, 184.5f, 207.0f, 138.0f, 69.0f, 43.0f, 17.0f, 89.5f, 162.0f, 162.0f,
      243.0f, 220.5f, 198.0f, 165.5f, 133.0f, 156.5f, 180.0f, 146.0f, 112.0f, 69.0f, 26.0f, 61.0f, 96.0f, 66.0f, 36.0f, 56.0f, 76.0f, 70.0f, 64.0f, 109.0f, 154.0f, 193.0f, 232.0f, 204.0f, 176.0f, 182.5f, 189.0f, 99.5f, 10.0f, 130.0f, 250.0f, 250.0f,
      64.0f, 35.5f, 7.0f, 18.5f, 30.0f, 111.0f, 192.0f, 168.0f, 144.0f, 91.5f, 39.0f, 50.0f, 61.0f, 108.5f, 156.0f, 192.0f, 228.0f, 139.0f, 50.0f, 42.0f, 34.0f, 59.5f, 85.0f, 135.5f, 186.0f, 183.5f, 181.0f, 109.5f, 38.0f, 103.5f, 169.0f, 169.0f,
    )

    ghExpected = Array[Float](
      103.0000f, 144.0000f, 132.0000f, 81.0000f, 63.0000f, 30.2500f, 84.0000f, 91.0000f, 19.0000f, 112.5000f, 140.0000f, 127.2500f, 240.0000f, 177.2500f, 50.0000f, 64.0000f, 73.0000f, 51.7500f, 96.0000f, 136.5000f, 146.0000f, 159.2500f, 135.0000f, 45.2500f, 5.0000f, 163.5000f, 240.0000f, 173.2500f, 197.0000f, 184.2500f, 145.0000f, 151.0000f,
      341.5000f, 229.0000f, 76.0000f, 84.0000f, 120.2500f, 85.0000f, 7.2500f, 17.0000f, 67.7500f, 59.0000f, 60.0000f, 22.0000f, 38.5000f, 105.0000f, 187.0000f, 186.0000f, 83.5000f, 102.0000f, 91.0000f, 80.0000f, 151.7500f, 168.0000f, 166.7500f, 153.0000f, 81.7500f, 46.0000f, 79.5000f, 62.0000f, 161.7500f, 244.0000f, 144.0000f, 91.0000f,
      179.0000f, 197.2500f, 176.0000f, 97.5000f, 110.0000f, 153.7500f, 196.0000f, 177.2500f, 60.0000f, 121.7500f, 215.0000f, 183.2500f, 138.0000f, 115.7500f, 210.0000f, 222.5000f, 149.0000f, 204.5000f, 195.0000f, 156.7500f, 221.0000f, 250.7500f, 249.0000f, 159.5000f, 45.0000f, 22.0000f, 27.0000f, 69.2500f, 113.0000f, 104.7500f, 54.0000f, 22.0000f,
      22.5000f, 113.0000f, 189.2500f, 160.0000f, 231.7500f, 221.0000f, 53.0000f, 25.0000f, 107.2500f, 117.0000f, 125.5000f, 171.0000f, 160.7500f, 219.0000f, 196.2500f, 14.0000f, 4.2500f, 65.0000f, 119.0000f, 202.0000f, 177.2500f, 190.0000f, 234.7500f, 173.0000f, 79.5000f, 41.0000f, 132.7500f, 207.0000f, 122.2500f, 148.0000f, 206.7500f, 171.0000f,
      194.0000f, 191.5000f, 223.0000f, 258.2500f, 211.0000f, 180.2500f, 243.0000f, 158.0000f, 68.0000f, 171.5000f, 231.0000f, 123.5000f, 24.0000f, 162.7500f, 205.0000f, 12.2500f, 18.0000f, 162.7500f, 185.0000f, 106.5000f, 45.0000f, 78.0000f, 30.0000f, -46.5000f, 46.0000f, 166.0000f, 191.0000f, 123.2500f, 22.0000f, -17.2500f, 37.0000f, 90.5000f,
      37.0000f, 14.0000f, 69.7500f, 192.0000f, 222.5000f, 172.0000f, 75.5000f, 103.0000f, 226.0000f, 169.0000f, 141.5000f, 202.0000f, 92.7500f, 72.0000f, 195.7500f, 220.0000f, 173.0000f, 158.0000f, 203.0000f, 174.0000f, 80.0000f, 132.0000f, 134.7500f, 20.0000f, 45.7500f, 19.0000f, -29.2500f, 101.0000f, 208.2500f, 180.0000f, 81.2500f, 22.0000f,
      71.0000f, 118.7500f, 90.0000f, 7.5000f, 97.0000f, 183.5000f, 73.0000f, 97.0000f, 254.0000f, 214.7500f, 190.0000f, 228.7500f, 209.0000f, 220.7500f, 220.0000f, 150.2500f, 73.0000f, 62.7500f, 117.0000f, 187.5000f, 192.0000f, 146.5000f, 151.0000f, 106.5000f, 54.0000f, 54.2500f, 18.0000f, 85.2500f, 167.0000f, 27.2500f, 3.0000f, 104.5000f,
      3.0000f, 33.0000f, 33.0000f, 91.0000f, 130.0000f, 50.0000f, 104.2500f, 185.0000f, 129.2500f, 88.0000f, 106.2500f, 120.0000f, 161.7500f, 199.0000f, 179.2500f, 105.0000f, 117.0000f, 211.0000f, 226.5000f, 164.0000f, 61.7500f, 97.0000f, 241.0000f, 222.0000f, 135.2500f, 148.0000f, 125.5000f, 20.0000f, 71.0000f, 200.0000f, 185.2500f, 151.0000f,
      95.0000f, 132.7500f, 143.0000f, 142.2500f, 189.0000f, 102.2500f, 36.0000f, 151.5000f, 180.0000f, 129.0000f, 183.0000f, 130.0000f, 50.0000f, 66.5000f, 52.0000f, 138.2500f, 185.0000f, 144.2500f, 86.0000f, 101.2500f, 251.0000f, 235.2500f, 108.0000f, 140.7500f, 196.0000f, 208.2500f, 217.0000f, 136.0000f, 142.0000f, 170.2500f, 124.0000f, 122.0000f,
      78.5000f, 101.0000f, 162.2500f, 217.0000f, 194.2500f, 127.0000f, 122.5000f, 200.0000f, 299.2500f, 243.0000f, 144.2500f, 245.0000f, 282.5000f, 235.0000f, 228.5000f, 192.0000f, 200.7500f, 139.0000f, 70.0000f, 158.0000f, 141.5000f, 43.0000f, 80.7500f, 118.0000f, 123.5000f, 206.0000f, 258.5000f, 212.0000f, 81.7500f, 2.0000f, 21.0000f, 25.0000f,
      77.0000f, 112.0000f, 77.0000f, 89.2500f, 242.0000f, 268.7500f, 184.0000f, 176.7500f, 176.0000f, 114.5000f, 114.0000f, 165.5000f, 175.0000f, 53.0000f, 23.0000f, 141.0000f, 89.0000f, 21.7500f, 102.0000f, 122.0000f, 44.0000f, 2.5000f, 18.0000f, 125.2500f, 232.0000f, 143.0000f, 1.0000f, -45.0000f, 28.0000f, 105.2500f, 36.0000f, -32.0000f,
      -60.0000f, 5.0000f, 88.5000f, 70.0000f, 53.7500f, 128.0000f, 217.2500f, 207.0000f, 104.2500f, 40.0000f, 45.7500f, 78.0000f, 69.5000f, 41.0000f, 29.5000f, 59.0000f, 57.2500f, 10.0000f, 82.7500f, 153.0000f, 191.7500f, 247.0000f, 282.2500f, 198.0000f, 41.5000f, 58.0000f, 181.7500f, 202.0000f, 145.2500f, 196.0000f, 137.5000f, 13.0000f,
      62.0000f, 186.2500f, 203.0000f, 131.5000f, 202.0000f, 192.5000f, 187.0000f, 175.0000f, 97.0000f, 74.7500f, 135.0000f, 221.2500f, 253.0000f, 199.0000f, 55.0000f, 96.0000f, 244.0000f, 152.0000f, 57.0000f, 122.2500f, 232.0000f, 237.2500f, 164.0000f, 124.2500f, 111.0000f, 172.5000f, 220.0000f, 188.0000f, 207.0000f, 245.0000f, 176.0000f, 113.0000f,
      93.0000f, 73.0000f, 150.0000f, 205.0000f, 130.5000f, 136.0000f, 214.7500f, 241.0000f, 193.2500f, 189.0000f, 192.0000f, 60.0000f, -22.0000f, 29.0000f, 79.5000f, 98.0000f, 82.5000f, 92.0000f, 64.0000f, 93.0000f, 168.0000f, 56.0000f, 27.0000f, 168.0000f, 111.5000f, 38.0000f, 92.7500f, 6.0000f, -10.5000f, 58.0000f, 120.2500f, 196.0000f,
      220.0000f, 138.7500f, 89.0000f, 163.7500f, 217.0000f, 146.5000f, 104.0000f, 127.7500f, 92.0000f, 152.0000f, 173.0000f, 115.0000f, 108.0000f, 70.2500f, 86.0000f, 154.5000f, 196.0000f, 177.7500f, 83.0000f, 31.7500f, 146.0000f, 269.0000f, 179.0000f, 76.2500f, 144.0000f, 203.5000f, 216.0000f, 220.2500f, 225.0000f, 224.2500f, 125.0000f, 43.5000f,
      169.0000f, 125.0000f, 87.5000f, 137.0000f, 152.0000f, 105.0000f, 96.7500f, 129.0000f, 139.2500f, 179.0000f, 194.2500f, 118.0000f, 103.0000f, 91.0000f, 72.5000f, 145.0000f, 259.2500f, 252.0000f, 162.7500f, 203.0000f, 151.0000f, 16.0000f, 25.0000f, 110.0000f, 159.7500f, 162.0000f, 199.5000f, 236.0000f, 200.0000f, 164.0000f, 113.5000f, 57.0000f,
      122.0000f, 142.5000f, 181.0000f, 248.7500f, 189.0000f, 56.7500f, 133.0000f, 213.0000f, 94.0000f, 25.2500f, 135.0000f, 166.5000f, 149.0000f, 145.5000f, 129.0000f, 239.5000f, 235.0000f, 115.5000f, 131.0000f, 110.7500f, 45.0000f, 23.2500f, 21.0000f, 49.5000f, 32.0000f, 76.7500f, 191.0000f, 139.0000f, 3.0000f, -24.0000f, 28.0000f, 57.0000f,
      -4.0000f, 51.0000f, 146.7500f, 185.0000f, 229.0000f, 179.0000f, 86.0000f, 121.0000f, 92.5000f, 95.0000f, 213.0000f, 157.0000f, 41.7500f, 149.0000f, 215.2500f, 126.0000f, 122.5000f, 193.0000f, 176.7500f, 90.0000f, 95.2500f, 103.0000f, 74.7500f, 96.0000f, 88.0000f, 46.0000f, 101.5000f, 213.0000f, 133.5000f, 68.0000f, 115.5000f, 116.0000f,
      125.0000f, 54.0000f, 41.0000f, 126.5000f, 133.0000f, 142.7500f, 215.0000f, 187.7500f, 128.0000f, 126.7500f, 17.0000f, 13.0000f, 168.0000f, 176.2500f, 101.0000f, 97.0000f, 179.0000f, 243.0000f, 231.0000f, 202.5000f, 140.0000f, 72.5000f, 63.0000f, 56.5000f, 0f, 47.2500f, 130.0000f, 43.2500f, 42.0000f, 144.7500f, 163.0000f, 159.5000f,
      269.0000f, 249.0000f, 116.7500f, 45.0000f, 76.5000f, 97.0000f, 88.2500f, 82.0000f, 121.2500f, 81.0000f, 63.5000f, 31.0000f, 68.7500f, 237.0000f, 269.2500f, 254.0000f, 198.5000f, 120.0000f, 124.5000f, 60.0000f, 4.2500f, 28.0000f, 15.2500f, 87.0000f, 158.7500f, 38.0000f, 42.2500f, 194.0000f, 220.2500f, 206.0000f, 171.5000f, 130.0000f,
      253.0000f, 245.7500f, 233.0000f, 171.2500f, 53.0000f, 41.2500f, 208.0000f, 212.5000f, 52.0000f, 57.7500f, 72.0000f, 68.2500f, 142.0000f, 187.5000f, 155.0000f, 112.7500f, 98.0000f, 47.5000f, 98.0000f, 183.0000f, 126.0000f, 103.0000f, 179.0000f, 246.7500f, 196.0000f, 121.0000f, 212.0000f, 217.7500f, 26.0000f, 6.2500f, 127.0000f, 162.5000f,
      39.0000f, 77.0000f, 190.2500f, 245.0000f, 127.5000f, 91.0000f, 140.5000f, 71.0000f, 35.0000f, 76.0000f, 126.5000f, 188.0000f, 109.7500f, 2.0000f, 115.5000f, 170.0000f, 156.0000f, 207.0000f, 196.0000f, 209.0000f, 183.7500f, 157.0000f, 142.0000f, 98.0000f, 159.5000f, 244.0000f, 296.5000f, 213.0000f, 76.0000f, 120.0000f, 209.2500f, 231.0000f,
      220.0000f, 242.7500f, 218.0000f, 122.5000f, 28.0000f, 61.0000f, 120.0000f, 119.2500f, 146.0000f, 145.7500f, 175.0000f, 142.2500f, 124.0000f, 128.7500f, 102.0000f, 96.5000f, 9.0000f, 38.0000f, 177.0000f, 128.2500f, 50.0000f, 121.5000f, 140.0000f, 114.5000f, 35.0000f, -21.0000f, 43.0000f, 158.5000f, 238.0000f, 123.2500f, 109.0000f, 204.5000f,
      129.5000f, 229.0000f, 295.0000f, 206.0000f, 105.5000f, 52.0000f, 106.5000f, 192.0000f, 174.5000f, 99.0000f, 111.5000f, 212.0000f, 194.5000f, 155.0000f, 203.0000f, 171.0000f, 49.0000f, 29.0000f, 104.2500f, 94.0000f, 63.0000f, 56.0000f, 98.0000f, 123.0000f, 136.7500f, 245.0000f, 178.2500f, 54.0000f, 207.7500f, 236.0000f, 140.7500f, 160.0000f,
      84.0000f, 14.5000f, 47.0000f, 127.5000f, 84.0000f, 118.0000f, 176.0000f, 123.2500f, 67.0000f, 102.7500f, 155.0000f, 141.2500f, 54.0000f, 126.7500f, 235.0000f, 151.5000f, 165.0000f, 269.0000f, 236.0000f, 91.5000f, 6.0000f, 57.5000f, 161.0000f, 168.5000f, 38.0000f, -8.2500f, 99.0000f, 140.0000f, 92.0000f, 82.5000f, 74.0000f, 49.5000f,
      64.0000f, 0f, 75.0000f, 226.0000f, 127.7500f, 100.0000f, 235.2500f, 236.0000f, 233.7500f, 251.0000f, 139.7500f, 102.0000f, 98.7500f, 68.0000f, 138.5000f, 135.0000f, 131.0000f, 162.0000f, 163.0000f, 220.0000f, 116.5000f, 68.0000f, 228.0000f, 240.0000f, 220.2500f, 248.0000f, 150.2500f, 101.0000f, 182.0000f, 219.0000f, 183.2500f, 158.0000f,
      164.0000f, 120.5000f, 13.0000f, 89.2500f, 209.0000f, 175.2500f, 197.0000f, 193.7500f, 224.0000f, 310.5000f, 225.0000f, 96.0000f, 97.0000f, 114.7500f, 73.0000f, 80.0000f, 132.0000f, 110.0000f, 123.0000f, 164.0000f, 136.0000f, 123.5000f, 162.0000f, 213.0000f, 207.0000f, 112.5000f, 69.0000f, 68.5000f, 17.0000f, 67.5000f, 162.0000f, 178.0000f,
      166.0000f, 222.0000f, 147.7500f, 8.0000f, 28.2500f, 96.0000f, 218.7500f, 205.0000f, 59.0000f, 21.0000f, 90.2500f, 146.0000f, 88.2500f, 123.0000f, 254.0000f, 226.0000f, 201.2500f, 232.0000f, 168.7500f, 146.0000f, 92.2500f, 48.0000f, 154.7500f, 231.0000f, 169.7500f, 134.0000f, 251.2500f, 254.0000f, 150.5000f, 224.0000f, 284.7500f, 253.0000f,
      243.0000f, 199.2500f, 198.0000f, 166.0000f, 133.0000f, 192.5000f, 180.0000f, 143.5000f, 112.0000f, 30.0000f, 26.0000f, 120.5000f, 96.0000f, 21.5000f, 36.0000f, 91.0000f, 76.0000f, 4.0000f, 64.0000f, 194.2500f, 154.0000f, 137.5000f, 232.0000f, 175.2500f, 176.0000f, 240.2500f, 189.0000f, 109.5000f, 10.0000f, 97.2500f, 250.0000f, 262.5000f,
      13.5000f, 9.0000f, -13.2500f, 3.0000f, 51.0000f, 42.0000f, 101.2500f, 118.0000f, 0.2500f, 60.0000f, 171.0000f, 81.0000f, -13.5000f, 12.0000f, 50.7500f, 77.0000f, 37.7500f, 10.0000f, 176.0000f, 245.0000f, 133.0000f, 115.0000f, 178.2500f, 223.0000f, 242.5000f, 229.0000f, 221.2500f, 241.0000f, 243.2500f, 194.0000f, 162.7500f, 180.0000f,
      64.0000f, 43.5000f, 7.0000f, -17.5000f, 30.0000f, 144.7500f, 192.0000f, 194.5000f, 144.0000f, 48.0000f, 39.0000f, 82.0000f, 61.0000f, 37.7500f, 156.0000f, 239.5000f, 228.0000f, 170.0000f, 50.0000f, 32.7500f, 34.0000f, 50.5000f, 85.0000f, 118.5000f, 186.0000f, 171.0000f, 181.0000f, 158.0000f, 38.0000f, 42.0000f, 169.0000f, 233.5000f,
      101.5000f, 154.0000f, 248.0000f, 243.0000f, 147.0000f, 81.0000f, 151.0000f, 243.0000f, 275.0000f, 252.0000f, 99.2500f, 56.0000f, 85.7500f, 66.0000f, 86.7500f, 117.0000f, 203.2500f, 175.0000f, 70.7500f, 162.0000f, 239.5000f, 222.0000f, 179.7500f, 119.0000f, 132.5000f, 169.0000f, 142.7500f, 112.0000f, 165.7500f, 164.0000f, 81.7500f, 49.0000f,
    )

    gvExpected = Array[Float](
      103.0000f, 284.5000f, 132.0000f, 126.0000f, 63.0000f, 55.5000f, 84.0000f, 4.0000f, 19.0000f, 82.0000f, 140.0000f, -16.5000f, 240.0000f, 144.0000f, 50.0000f, 121.5000f, 73.0000f, 15.0000f, 96.0000f, 101.0000f, 146.0000f, 163.5000f, 135.0000f, 117.0000f, 5.0000f, 53.0000f, 240.0000f, 2.0000f, 197.0000f, 206.0000f, 145.0000f, 91.0000f,
      182.2500f, 229.0000f, 93.7500f, 84.0000f, 58.0000f, 85.0000f, 148.7500f, 17.0000f, 59.2500f, 59.0000f, 214.7500f, 22.0000f, 205.7500f, 105.0000f, 117.0000f, 186.0000f, 106.5000f, 102.0000f, 174.7500f, 80.0000f, 232.0000f, 168.0000f, 213.2500f, 153.0000f, 66.0000f, 46.0000f, 184.5000f, 62.0000f, 199.2500f, 244.0000f, 73.0000f, 91.0000f,
      179.0000f, 154.2500f, 176.0000f, 75.2500f, 110.0000f, 192.0000f, 196.0000f, 54.2500f, 60.0000f, 59.0000f, 215.0000f, 91.7500f, 138.0000f, 101.2500f, 210.0000f, 180.2500f, 149.0000f, 122.0000f, 195.0000f, 101.2500f, 221.0000f, 170.5000f, 249.0000f, 213.5000f, 45.0000f, 18.7500f, 27.0000f, 151.0000f, 113.0000f, 226.7500f, 54.0000f, 100.0000f,
      142.0000f, 113.0000f, 313.2500f, 160.0000f, 213.2500f, 221.0000f, 205.0000f, 25.0000f, 16.5000f, 117.0000f, 189.7500f, 171.0000f, 74.5000f, 219.0000f, 227.0000f, 14.0000f, 60.7500f, 65.0000f, 119.0000f, 202.0000f, 79.7500f, 190.0000f, 96.2500f, 173.0000f, -29.2500f, 41.0000f, 66.2500f, 207.0000f, -24.5000f, 148.0000f, 91.2500f, 171.0000f,
      194.0000f, 24.2500f, 223.0000f, 228.7500f, 211.0000f, 127.2500f, 243.0000f, 65.5000f, 68.0000f, 193.0000f, 231.0000f, 218.0000f, 24.0000f, 202.5000f, 205.0000f, 51.0000f, 18.0000f, 167.7500f, 185.0000f, 244.2500f, 45.0000f, 216.0000f, 30.0000f, 60.0000f, 46.0000f, 87.5000f, 191.0000f, 214.7500f, 22.0000f, 186.5000f, 37.0000f, 137.7500f,
      154.0000f, 14.0000f, 94.7500f, 192.0000f, 99.2500f, 172.0000f, 130.0000f, 103.0000f, 200.5000f, 169.0000f, 166.5000f, 202.0000f, 60.7500f, 72.0000f, 201.5000f, 220.0000f, 86.7500f, 158.0000f, 200.2500f, 174.0000f, 126.2500f, 132.0000f, 115.2500f, 20.0000f, 109.0000f, 19.0000f, 68.0000f, 101.0000f, 191.2500f, 180.0000f, 20.2500f, 22.0000f,
      71.0000f, 77.0000f, 90.0000f, 115.2500f, 97.0000f, 194.5000f, 73.0000f, 83.2500f, 254.0000f, 102.5000f, 190.0000f, 153.7500f, 209.0000f, 98.0000f, 220.0000f, 146.0000f, 73.0000f, 102.0000f, 117.0000f, 155.0000f, 192.0000f, 27.2500f, 151.0000f, 106.7500f, 54.0000f, 38.5000f, 18.0000f, -2.5000f, 167.0000f, 96.7500f, 3.0000f, 69.0000f,
      37.2500f, 33.0000f, 101.0000f, 91.0000f, 185.7500f, 50.0000f, 99.2500f, 185.0000f, 187.2500f, 88.0000f, 264.5000f, 120.0000f, 167.0000f, 199.0000f, 126.7500f, 105.0000f, 83.2500f, 211.0000f, 120.5000f, 164.0000f, 185.7500f, 97.0000f, 144.5000f, 222.0000f, 86.7500f, 148.0000f, 113.2500f, 20.0000f, 61.5000f, 200.0000f, 2.2500f, 151.0000f,
      95.0000f, 8.0000f, 143.0000f, 140.7500f, 189.0000f, 12.2500f, 36.0000f, 228.0000f, 180.0000f, 156.0000f, 183.0000f, 195.2500f, 50.0000f, 275.2500f, 52.0000f, 181.5000f, 185.0000f, 232.0000f, 86.0000f, 118.5000f, 251.0000f, 144.5000f, 108.0000f, 196.5000f, 196.0000f, 182.2500f, 217.0000f, 141.2500f, 142.0000f, 166.5000f, 124.0000f, 134.7500f,
      122.7500f, 101.0000f, 121.7500f, 217.0000f, 217.7500f, 127.0000f, 72.5000f, 200.0000f, 219.2500f, 243.0000f, 86.5000f, 245.0000f, 135.7500f, 235.0000f, 73.2500f, 192.0000f, 162.0000f, 139.0000f, 19.5000f, 158.0000f, 170.7500f, 43.0000f, 25.0000f, 118.0000f, 255.5000f, 206.0000f, 170.7500f, 212.0000f, 161.2500f, 2.0000f, 128.5000f, 25.0000f,
      77.0000f, 89.2500f, 77.0000f, 177.2500f, 242.0000f, 204.5000f, 184.0000f, 200.0000f, 176.0000f, 140.5000f, 114.0000f, 130.2500f, 175.0000f, 75.2500f, 23.0000f, 183.7500f, 89.0000f, 50.0000f, 102.0000f, 206.0000f, 44.0000f, 83.0000f, 18.0000f, 135.5000f, 232.0000f, 124.0000f, 1.0000f, 169.2500f, 28.0000f, 81.5000f, 36.0000f, -34.0000f,
      19.0000f, 5.0000f, 153.2500f, 70.0000f, 211.2500f, 128.0000f, 223.5000f, 207.0000f, 109.0000f, 40.0000f, 126.0000f, 78.0000f, 238.7500f, 41.0000f, 43.0000f, 59.0000f, 221.7500f, 10.0000f, 163.2500f, 153.0000f, 140.7500f, 247.0000f, 163.7500f, 198.0000f, 110.0000f, 58.0000f, 57.7500f, 202.0000f, 90.2500f, 196.0000f, 144.0000f, 13.0000f,
      62.0000f, 74.5000f, 203.0000f, 84.7500f, 202.0000f, 73.5000f, 187.0000f, 205.5000f, 97.0000f, 96.5000f, 135.0000f, 123.0000f, 253.0000f, 102.0000f, 55.0000f, -4.2500f, 244.0000f, 24.0000f, 57.0000f, 113.2500f, 232.0000f, 169.7500f, 164.0000f, 228.7500f, 111.0000f, 62.7500f, 220.0000f, 123.7500f, 207.0000f, 143.0000f, 176.0000f, 132.2500f,
      216.7500f, 73.0000f, 191.2500f, 205.0000f, 209.7500f, 136.0000f, 166.5000f, 241.0000f, 113.2500f, 189.0000f, 180.0000f, 60.0000f, 111.2500f, 29.0000f, 47.5000f, 98.0000f, 145.2500f, 92.0000f, 52.0000f, 93.0000f, 221.2500f, 56.0000f, 100.2500f, 168.0000f, 144.5000f, 38.0000f, 243.5000f, 6.0000f, 160.7500f, 58.0000f, 45.7500f, 196.0000f,
      220.0000f, 30.5000f, 89.0000f, 178.7500f, 217.0000f, 175.7500f, 104.0000f, 209.5000f, 92.0000f, 250.7500f, 173.0000f, 28.5000f, 108.0000f, -25.0000f, 86.0000f, 117.0000f, 196.0000f, 225.0000f, 83.0000f, 116.0000f, 146.0000f, 85.0000f, 179.0000f, 85.5000f, 144.0000f, 124.2500f, 216.0000f, 148.2500f, 225.0000f, 158.2500f, 125.0000f, 109.2500f,
      125.7500f, 125.0000f, 28.2500f, 137.0000f, 161.5000f, 105.0000f, 87.2500f, 129.0000f, 74.7500f, 179.0000f, 141.0000f, 118.0000f, 183.7500f, 91.0000f, 56.2500f, 145.0000f, 242.5000f, 252.0000f, 41.2500f, 203.0000f, 73.2500f, 16.0000f, 130.5000f, 110.0000f, 137.5000f, 162.0000f, 250.0000f, 236.0000f, 199.2500f, 164.0000f, 151.0000f, 57.0000f,
      122.0000f, 151.2500f, 181.0000f, 197.5000f, 189.0000f, 74.5000f, 133.0000f, 116.7500f, 94.0000f, 35.0000f, 135.0000f, 194.0000f, 149.0000f, 181.0000f, 129.0000f, 203.0000f, 235.0000f, 152.0000f, 131.0000f, 149.2500f, 45.0000f, 24.2500f, 21.0000f, 126.7500f, 32.0000f, 80.5000f, 191.0000f, 229.0000f, 3.0000f, 21.5000f, 28.0000f, 63.5000f,
      153.0000f, 51.0000f, 227.5000f, 185.0000f, 233.2500f, 179.0000f, 144.5000f, 121.0000f, 86.2500f, 95.0000f, 112.0000f, 157.0000f, 134.5000f, 149.0000f, 186.7500f, 126.0000f, 197.2500f, 193.0000f, 236.0000f, 90.0000f, 111.5000f, 103.0000f, 29.2500f, 96.0000f, -59.2500f, 46.0000f, 108.7500f, 213.0000f, -23.0000f, 68.0000f, 90.5000f, 116.0000f,
      125.0000f, 93.2500f, 41.0000f, 110.0000f, 133.0000f, 197.7500f, 215.0000f, 95.0000f, 128.0000f, 164.7500f, 17.0000f, 52.0000f, 168.0000f, 177.0000f, 101.0000f, 162.0000f, 179.0000f, 246.2500f, 231.0000f, 88.5000f, 140.0000f, 62.5000f, 63.0000f, 70.7500f, 0f, 35.7500f, 130.0000f, 129.5000f, 42.0000f, 221.5000f, 163.0000f, 171.7500f,
      175.7500f, 249.0000f, 57.2500f, 45.0000f, 65.2500f, 97.0000f, 231.2500f, 82.0000f, 155.2500f, 81.0000f, 21.7500f, 31.0000f, 110.7500f, 237.0000f, 96.2500f, 254.0000f, 179.0000f, 120.0000f, 184.7500f, 60.0000f, 87.2500f, 28.0000f, 88.2500f, 87.0000f, 152.5000f, 38.0000f, 125.7500f, 194.0000f, 76.5000f, 206.0000f, 137.2500f, 130.0000f,
      253.0000f, 163.0000f, 233.0000f, 134.2500f, 53.0000f, 55.0000f, 208.0000f, 143.5000f, 52.0000f, 89.0000f, 72.0000f, 111.5000f, 142.0000f, 103.7500f, 155.0000f, 158.0000f, 98.0000f, 96.7500f, 98.0000f, 139.0000f, 126.0000f, 58.0000f, 179.0000f, 115.5000f, 196.0000f, 155.0000f, 212.0000f, 296.7500f, 26.0000f, 113.2500f, 127.0000f, 120.2500f,
      240.7500f, 77.0000f, 228.0000f, 245.0000f, 30.0000f, 91.0000f, 203.5000f, 71.0000f, 52.7500f, 76.0000f, 137.2500f, 188.0000f, 181.2500f, 2.0000f, 127.5000f, 170.0000f, 8.0000f, 207.0000f, 73.0000f, 209.0000f, 105.7500f, 157.0000f, 206.2500f, 98.0000f, 128.5000f, 244.0000f, 178.7500f, 213.0000f, 40.5000f, 120.0000f, 147.7500f, 231.0000f,
      220.0000f, 226.7500f, 218.0000f, 203.5000f, 28.0000f, 45.0000f, 120.0000f, 25.2500f, 146.0000f, 13.2500f, 175.0000f, 174.7500f, 124.0000f, 114.7500f, 102.0000f, 258.0000f, 9.0000f, 112.5000f, 177.0000f, 181.0000f, 50.0000f, 183.0000f, 140.0000f, 105.5000f, 35.0000f, 232.2500f, 43.0000f, 74.2500f, 238.0000f, 179.0000f, 109.0000f, 286.5000f,
      96.5000f, 229.0000f, 189.5000f, 206.0000f, 61.7500f, 52.0000f, 73.7500f, 192.0000f, 110.0000f, 99.0000f, 140.0000f, 212.0000f, 81.2500f, 155.0000f, 184.5000f, 171.0000f, 113.2500f, 29.0000f, 295.0000f, 94.0000f, 53.2500f, 56.0000f, 109.7500f, 123.0000f, 1.2500f, 245.0000f, 100.5000f, 54.0000f, 245.5000f, 236.0000f, 29.0000f, 160.0000f,
      84.0000f, 31.2500f, 47.0000f, 290.5000f, 84.0000f, 162.0000f, 176.0000f, 294.7500f, 67.0000f, 216.5000f, 155.0000f, 247.0000f, 54.0000f, 104.2500f, 235.0000f, 129.5000f, 165.0000f, 171.2500f, 236.0000f, 122.5000f, 6.0000f, 25.5000f, 161.0000f, 196.0000f, 38.0000f, 229.5000f, 99.0000f, 97.0000f, 92.0000f, 238.0000f, 74.0000f, 89.2500f,
      206.7500f, 0f, -29.0000f, 226.0000f, 132.0000f, 100.0000f, 239.7500f, 236.0000f, 184.7500f, 251.0000f, 209.7500f, 102.0000f, 112.0000f, 68.0000f, 144.5000f, 135.0000f, 138.5000f, 162.0000f, 125.2500f, 220.0000f, 51.0000f, 68.0000f, 214.0000f, 240.0000f, 123.2500f, 248.0000f, 20.5000f, 101.0000f, 61.2500f, 219.0000f, 125.2500f, 158.0000f,
      164.0000f, 182.5000f, 13.0000f, 52.2500f, 209.0000f, 3.0000f, 197.0000f, 174.7500f, 224.0000f, 172.2500f, 225.0000f, 23.0000f, 97.0000f, 83.5000f, 73.0000f, 135.7500f, 132.0000f, 151.0000f, 123.0000f, 173.2500f, 136.0000f, 71.2500f, 162.0000f, 241.2500f, 207.0000f, 172.5000f, 69.0000f, 166.7500f, 17.0000f, 222.0000f, 162.0000f, 228.0000f,
      142.5000f, 222.0000f, 134.7500f, 8.0000f, 167.7500f, 96.0000f, 193.5000f, 205.0000f, 133.2500f, 21.0000f, 60.5000f, 146.0000f, 51.5000f, 123.0000f, 75.7500f, 226.0000f, 75.7500f, 232.0000f, 48.0000f, 146.0000f, 143.2500f, 48.0000f, 174.0000f, 231.0000f, 200.0000f, 134.0000f, 187.2500f, 254.0000f, -31.0000f, 224.0000f, 283.5000f, 253.0000f,
      243.0000f, 46.7500f, 198.0000f, 19.2500f, 133.0000f, 106.5000f, 180.0000f, 156.7500f, 112.0000f, 8.2500f, 26.0000f, 174.2500f, 96.0000f, 69.2500f, 36.0000f, 142.2500f, 76.0000f, 55.7500f, 64.0000f, 219.7500f, 154.0000f, 50.0000f, 232.0000f, 216.2500f, 176.0000f, 260.5000f, 189.0000f, 262.7500f, 10.0000f, 214.5000f, 250.0000f, 194.2500f,
      175.2500f, 9.0000f, 65.5000f, 3.0000f, 106.5000f, 42.0000f, 177.2500f, 118.0000f, 100.2500f, 60.0000f, 136.7500f, 81.0000f, 65.7500f, 12.0000f, 64.7500f, 77.0000f, 164.5000f, 10.0000f, 154.2500f, 245.0000f, 61.0000f, 115.0000f, 132.0000f, 223.0000f, 167.0000f, 229.0000f, 126.2500f, 241.0000f, 7.5000f, 194.0000f, 123.0000f, 180.0000f,
      64.0000f, 112.2500f, 7.0000f, 124.5000f, 30.0000f, 70.2500f, 192.0000f, 198.7500f, 144.0000f, 154.7500f, 39.0000f, 52.2500f, 61.0000f, 35.2500f, 156.0000f, 132.0000f, 228.0000f, 153.7500f, 50.0000f, 194.0000f, 34.0000f, 182.7500f, 85.0000f, 162.5000f, 186.0000f, 156.0000f, 181.0000f, 169.2500f, 38.0000f, 169.0000f, 169.0000f, 130.5000f,
      68.5000f, 154.0000f, 68.5000f, 243.0000f, 11.0000f, 81.0000f, 179.5000f, 243.0000f, 202.5000f, 252.0000f, -64.0000f, 56.0000f, 107.0000f, 66.0000f, 181.5000f, 117.0000f, 255.0000f, 175.0000f, -47.5000f, 162.0000f, 104.5000f, 222.0000f, 134.5000f, 119.0000f, 214.5000f, 169.0000f, 244.5000f, 112.0000f, 104.5000f, 164.0000f, 234.5000f, 49.0000f,
    )

    //    dstGExpected = Array[Float](
    //      103, 144, 132, 81, 63, 30, 84, 91, 19, 113, 140, 127, 240, 177, 50, 64, 73, 52, 96, 137, 146, 159, 135, 45, 5, 164, 240, 173, 197, 184, 145, 91,
    //      182, 229, 94, 84, 58, 85, 7, 17, 68, 59, 215, 22, 206, 105, 117, 186, 84, 102, 175, 80, 152, 168, 213, 153, 66, 46, 185, 62, 199, 244, 144, 91,
    //      179, 197, 176, 98, 110, 154, 196, 177, 60, 59, 215, 92, 138, 101, 210, 223, 149, 122, 195, 101, 221, 171, 249, 214, 45, 19, 27, 151, 113, 227, 54, 100,
    //      142, 113, 313, 160, 213, 221, 53, 25, 107, 117, 126, 171, 75, 219, 227, 14, 4, 65, 119, 202, 177, 190, 96, 173, 0, 41, 66, 207, 0, 148, 91, 171,
    //      194, 192, 223, 258, 211, 180, 243, 158, 68, 193, 231, 218, 24, 163, 205, 12, 18, 163, 185, 107, 45, 216, 30, 60, 46, 88, 191, 215, 22, 187, 37, 138,
    //      154, 14, 95, 192, 99, 172, 76, 103, 226, 169, 167, 202, 93, 72, 196, 220, 173, 158, 203, 174, 126, 132, 115, 20, 109, 19, 68, 101, 191, 180, 20, 22,
    //      71, 77, 90, 115, 97, 184, 73, 97, 254, 103, 190, 154, 209, 221, 220, 150, 73, 63, 117, 155, 192, 27, 151, 107, 54, 54, 18, 85, 167, 27, 3, 69,
    //      37, 33, 101, 91, 130, 50, 104, 185, 187, 88, 265, 120, 162, 199, 179, 105, 117, 211, 121, 164, 62, 97, 241, 222, 135, 148, 126, 20, 71, 200, 185, 151,
    //      95, 8, 143, 141, 189, 12, 36, 228, 180, 156, 183, 195, 50, 275, 52, 138, 185, 232, 86, 119, 251, 235, 108, 197, 196, 208, 217, 136, 142, 170, 124, 135,
    //      123, 101, 162, 217, 194, 127, 73, 200, 219, 243, 87, 245, 283, 235, 229, 192, 201, 139, 20, 158, 142, 43, 81, 118, 124, 206, 259, 212, 161, 2, 21, 25,
    //      77, 89, 77, 177, 242, 205, 184, 200, 176, 115, 114, 166, 175, 75, 23, 184, 89, 50, 102, 206, 44, 83, 18, 136, 232, 143, 1, 0, 28, 82, 36, 0,
    //      19, 5, 153, 70, 211, 128, 224, 207, 109, 40, 46, 78, 70, 41, 30, 59, 57, 10, 163, 153, 141, 247, 282, 198, 42, 58, 182, 202, 90, 196, 138, 13,
    //      62, 75, 203, 85, 202, 74, 187, 206, 97, 75, 135, 221, 253, 199, 55, 96, 244, 152, 57, 122, 232, 237, 164, 124, 111, 173, 220, 188, 207, 245, 176, 132,
    //      217, 73, 191, 205, 210, 136, 215, 241, 113, 189, 180, 60, 0, 29, 80, 98, 83, 92, 52, 93, 221, 56, 27, 168, 112, 38, 93, 6, 0, 58, 120, 196,
    //      220, 139, 89, 179, 217, 176, 104, 210, 92, 251, 173, 115, 108, 70, 86, 155, 196, 178, 83, 32, 146, 269, 179, 76, 144, 204, 216, 220, 225, 224, 125, 109,
    //      126, 125, 28, 137, 152, 105, 97, 129, 139, 179, 194, 118, 103, 91, 56, 145, 243, 252, 41, 203, 73, 16, 25, 110, 160, 162, 200, 236, 200, 164, 114, 57,
    //      122, 151, 181, 249, 189, 75, 133, 213, 94, 25, 135, 194, 149, 181, 129, 240, 235, 116, 131, 111, 45, 23, 21, 50, 32, 77, 191, 139, 3, 0, 28, 64,
    //      153, 51, 228, 185, 233, 179, 145, 121, 93, 95, 112, 157, 135, 149, 187, 126, 123, 193, 177, 90, 95, 103, 75, 96, 0, 46, 109, 213, 0, 68, 91, 116,
    //      125, 54, 41, 110, 133, 198, 215, 95, 128, 165, 17, 52, 168, 176, 101, 97, 179, 243, 231, 203, 140, 73, 63, 71, 0, 36, 130, 130, 42, 222, 163, 172,
    //      176, 249, 57, 45, 65, 97, 231, 82, 121, 81, 22, 31, 111, 237, 96, 254, 179, 120, 185, 60, 4, 28, 15, 87, 153, 38, 126, 194, 220, 206, 172, 130,
    //      253, 246, 233, 171, 53, 55, 208, 144, 52, 89, 72, 112, 142, 188, 155, 113, 98, 48, 98, 183, 126, 58, 179, 116, 196, 121, 212, 218, 26, 113, 127, 120,
    //      241, 77, 190, 245, 30, 91, 204, 71, 35, 76, 127, 188, 110, 2, 128, 170, 8, 207, 196, 209, 106, 157, 206, 98, 129, 244, 297, 213, 76, 120, 148, 231,
    //      220, 243, 218, 123, 28, 45, 120, 119, 146, 146, 175, 175, 124, 115, 102, 258, 9, 38, 177, 128, 50, 183, 140, 106, 35, 232, 43, 159, 238, 179, 109, 287,
    //      97, 229, 295, 206, 62, 52, 74, 192, 175, 99, 112, 212, 81, 155, 185, 171, 113, 29, 104, 94, 63, 56, 110, 123, 1, 245, 178, 54, 208, 236, 29, 160,
    //      84, 31, 47, 291, 84, 162, 176, 123, 67, 103, 155, 247, 54, 104, 235, 152, 165, 269, 236, 92, 6, 58, 161, 169, 38, 0, 99, 140, 92, 238, 74, 89,
    //      207, 0, 0, 226, 132, 100, 240, 236, 234, 251, 140, 102, 112, 68, 145, 135, 131, 162, 163, 220, 117, 68, 214, 240, 220, 248, 150, 101, 182, 219, 183, 158,
    //      164, 183, 13, 52, 209, 3, 197, 194, 224, 311, 225, 23, 97, 115, 73, 80, 132, 110, 123, 164, 136, 124, 162, 213, 207, 113, 69, 69, 17, 222, 162, 228,
    //      143, 222, 135, 8, 168, 96, 194, 205, 59, 21, 90, 146, 88, 123, 254, 226, 201, 232, 169, 146, 92, 48, 155, 231, 170, 134, 251, 254, 151, 224, 285, 253,
    //      243, 47, 198, 166, 133, 193, 180, 144, 112, 30, 26, 121, 96, 22, 36, 91, 76, 4, 64, 220, 154, 50, 232, 216, 176, 261, 189, 263, 10, 215, 250, 194,
    //      175, 9, 0, 3, 51, 42, 177, 118, 0, 60, 171, 81, 0, 12, 51, 77, 38, 10, 176, 245, 133, 115, 178, 223, 167, 229, 221, 241, 243, 194, 163, 180,
    //      64, 44, 7, 0, 30, 70, 192, 199, 144, 48, 39, 82, 61, 38, 156, 240, 228, 170, 50, 194, 34, 183, 85, 163, 186, 156, 181, 169, 38, 169, 169, 131,
    //      69, 154, 248, 243, 147, 81, 151, 243, 275, 252, 99, 56, 86, 66, 87, 117, 203, 175, 71, 162, 240, 222, 180, 119, 133, 169, 143, 112, 166, 164, 82, 49,
    //    )

    //    interpDirExpected = Array[Int](
    //      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1,
    //      1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1,
    //      1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1,
    //      1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1,
    //      1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1,
    //      1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1,
    //      1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1,
    //      1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1,
    //      1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1,
    //      1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1,
    //      1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1,
    //      1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1,
    //      1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1,
    //      1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 1,
    //      1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1,
    //      1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1,
    //      1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1,
    //      1, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    //      1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1,
    //      1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1,
    //      1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1,
    //      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
    //    ).map(_.toByte)
  }


}
